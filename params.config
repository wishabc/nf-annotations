// Common params
conda = "/home/sabramov/miniconda3/envs/jupyterlab"
samples_file = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/downsampled_no_cancer/metadata.tsv"

outdir = "$launchDir/output"

//////////////////////////////////////////////////////////////////////////////////////
// Moods params, see nf-genotyping for the script to create these files
moods_scans_dir = "/net/seq/data2/projects/sabramov/ENCODE4/dnase-genotypesv3/round2/output/moods_scans_alt" // Pre-made MOODs scans
masterlist_file = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/downsampled_no_cancer/output/masterlist.only_autosomes.filtered.bed"
binary_matrix = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/downsampled_no_cancer/output/binary.only_autosomes.filtered.matrix.npy"
genome_fasta_file = "/net/seq/data/genomes/human/GRCh38/noalts/GRCh38_no_alts.fa"
sample_names = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/downsampled_no_cancer/output/samples_order.txt"
dhs_annotations = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/full/output/annotations/masterlist_DHSs_Altius.filtered.annotated.bed"
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////  LDSC pipeline  ////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Phenotypes to calculate LDSC regression on. Full meta is available here https://pan.ukbb.broadinstitute.org/downloads/index.html
phenotypes_meta = "/net/seq/data2/projects/GWAS/UKBB_2023/sabramov/UKBB_meta.filtered.h2_0.05.tsv" 

// SNP annotation files
annotations_dir = "/home/sabramov/projects/ENCODE4/anova/categories" // Directory with annotations. One BED file per annotaion.
min_snps = 10000
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////  Create baseline annotation  ////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
base_ann_path = '/home/sabramov/LDSC/baselineLD_v2.2/baselineLD.'

// HapMap3 SNPs (as recommended by LDSC manual)
tested_snps = "/net/seq/data2/projects/sabramov/LDSC/UKBB_hm3.snps.tsv" 

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////  Run LDSC on custom annotations  ////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Path to created baseline annotation (result of calcBaseline workflow)
baseline_ld = "/net/seq/data2/projects/sabramov/LDSC/baseline_UKBB/output/ldsc/l2/baseline."

// LDSC data, see https://github.com/bulik/ldsc for details
ldsc_scripts_path = "/home/sabramov/projects/ENCODE4/ldsc" // TODO put in docker
ldsc_conda = "/home/sabramov/miniconda3/envs/ldsc" // TODO put in docker

// If true, run cell-type specific LDSC. Faster, but no by-category prop h^2
by_cell_type = false

// All paths below should have "." at the end, see https://github.com/bulik/ldsc for file description
frqfiles = "/home/sabramov/LDSC/plink_files/1000G.EUR.hg38."
gtfiles = "/home/sabramov/LDSC/plink_files/1000G.EUR.hg38."
weights = "/home/sabramov/LDSC/weights/weights.hm3_noMHC."

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// Context extraction
window = 20 // window in which extract context overlapping each variant

// Mutation rates
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Directories for Motif Enrichment by Logistics Regression
// logistic regression
metadf = "/net/seq/data2/projects/afathul/motif_enhancement/motifs_meta.tsv"
mappable_file = '/net/seq/data/genomes/human/GRCh38/noalts/GRCh38_no_alts.K76.mappable_only.bed'
genome_fasta = '/net/seq/data/genomes/human/GRCh38/noalts/GRCh38_no_alts.fa'
index_file = '/net/seq/data2/projects/afathul/motif_enhancement/masterlist.filtered.bed'

// logistic regression GWAS
matrix_file_pheno = "/net/seq/data2/projects/afathul/gwas_enrichment/pheno_matrix_file.tsv"
masterlist_file2 = "/net/seq/data2/projects/afathul/motif_enhancement/masterlist.filtered.bed"
masterlist_ori = "/net/seq/data2/projects/afathul/motif_enrichment/odd_ratio/metadata_new.bed"

// hyperGeom
reference_sample_meta = "/home/afathul/data2seq/motif_enrichment/odd_ratio/oddratio_dnase_3501/reference_samples/metadata_reference_sample.bed"

// "/home/afathul/data2seq/motif_enrichment/odd_ratio/oddratio_dnase_3501/all_samples/nmf/metadata_all_sample.bed"

nmf_matrix = "/net/seq/data2/projects/sabramov/SuperIndex/clean_index_clustering/dnase_3501/reference_samples/output/binary.only_autosomes.filtered.matrix.npy"
// ref_nmf = np.load('/net/seq/data2/projects/aabisheva/Encode/nextflow_results/nmf_results/november_3517_samples_727k_interesting_peaks.24.H.npy').T
// all_nmf = np.load('/net/seq/data2/projects/aabisheva/Encode/nextflow_results/nmf_results/november/november_3517_samples_727k_interesting_peaks.24.H_new.npy').T

// all_binary = "/net/seq/data2/projects/sabramov/SuperIndex/clean_index_clustering/dnase_3501/reference_samples/output/binary.only_autosomes.filtered.matrix.npy" (1730560, 3517)
// ref_binary = 



// nmf = "/home/afathul/data2seq/motif_enrichment/odd_ratio/oddratio_dnase_3501/reference_samples/nmf/nmf_metadata.tsv"
// binary = "/net/seq/data2/projects/sabramov/SuperIndex/clean_index_clustering/dnase_3501/reference_samples/samples_meta.tsv"
// metadata_file = "/home/afathul/data2seq/motif_enrichment/dnase3501_final/metadata_all_sample.bed"
// dhs_index_masterlist = "/net/seq/data2/projects/ENCODE4Plus/indexes/index_altius_23-10-04/output/annotations/masterlist_DHSs_0802.filtered.annotated.bed"

// Directories for Motif Enrichment: workflow matchingBackground
matching_bins = 300
acc_proportion = "/home/afathul/data2seq/motif_enrichment/dnase3501_final/acc_proportion.tsv"
binary_dhs_agid = "/home/afathul/data2seq/motif_enrichment/dnase3501_final/binary.only_autosomes.filtered.matrix.npy"
binary_nmf = "/home/afathul/data2seq/motif_enrichment/dnase3501_final/november_3517_samples_727k_interesting_peaks.24.H_new_MaxBinary.npy"


// These matrix are transformed to binary with notebook data_transformation.py
dhs_agid = "/net/seq/data2/projects/sabramov/SuperIndex/dnase-index0415/matrices/downsampled/output/binary.only_autosomes.filtered.matrix.npy"
nmf = "/net/seq/data2/projects/aabisheva/Encode/nextflow_results/nmf_results/november/november_3517_samples_727k_interesting_peaks.24.H_new.npy"
